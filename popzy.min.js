Popzy.elements=[];function Popzy(options={}){this.opt=Object.assign({footer:false,closeMethods:["button","overlay","escape"],cssClass:[],destroyOnClose:true},options);this.template=document.querySelector(`#${this.opt.templateId}`);if(!this.template)return console.error(`#${this.opt.templateId} does not exist!`);const{closeMethods:closeMethods}=this.opt;this._allButtonClose=closeMethods.includes("button");this._allBackdropClose=closeMethods.includes("overlay");this._allEscapeClose=closeMethods.includes("escape");this._footerButtons=[];this._handleEscapeKey=this._handleEscapeKey.bind(this)}Popzy.prototype._getScrollbarWidth=function(){if(this._scrollbarwidth)return this._scrollbarwidth;const div=document.createElement("div");Object.assign(div.style,{overflow:"scroll",position:"absolute",top:"-9999px"});document.body.appendChild(div);this._scrollbarwidth=div.offsetWidth-div.clientWidth;document.body.removeChild(div);return this._scrollbarwidth};Popzy.prototype._onTransitionEnd=function(callback){this._backdrop.ontransitionend=e=>{if(e.propertyName!=="transform")return;if(typeof callback==="function")callback()}};Popzy.prototype.setFooterContent=function(html){this._footerContent=html;this._renderFooterContent()};Popzy.prototype._renderFooterContent=function(){if(this._modalFooter&&this._footerContent){this._modalFooter.innerHTML=this._footerContent}};Popzy.prototype._renderFooterBtn=function(){if(this._modalFooter){this._footerButtons.forEach(btn=>{this._modalFooter.append(btn)})}};Popzy.prototype.addFooterButton=function(title,css,callback){const btnFooter=this._createElement("button",css,title);btnFooter.onclick=callback;this._footerButtons.push(btnFooter);this._renderFooterBtn()};Popzy.prototype._handleEscapeKey=function(e){const lastModal=Popzy.elements[Popzy.elements.length-1];if(e.key==="Escape"&&this===lastModal){lastModal.close()}};Popzy.prototype._createElement=function(ele,css="",title=""){const element=document.createElement(ele);element.className=css;element.innerHTML=title;return element};Popzy.prototype.build=function(){const content=this.template.content.cloneNode(true);this._backdrop=this._createElement("div","popzy__backdrop");const container=this._createElement("div","popzy__container");this.opt.cssClass.forEach(className=>{if(typeof className==="string"){container.classList.add(className)}});if(this._allButtonClose){const btnClose=this._createElement("button","snapmodal__close","&times;");btnClose.onclick=()=>this.close();container.append(btnClose)}const modalContent=this._createElement("div","popzy__content");modalContent.append(content);container.append(modalContent);if(this.opt.footer){this._modalFooter=this._createElement("div","popzy__footer");this._renderFooterContent();this._renderFooterBtn();modalContent.append(this._modalFooter)}this._backdrop.append(container);document.body.append(this._backdrop)};Popzy.prototype.open=function(){Popzy.elements.push(this);if(!this._backdrop)this.build();setTimeout(()=>{this._backdrop.classList.add("popzy--show")},0);document.body.classList.add("popzy--no-scrolling");document.body.style.paddingRight=this._getScrollbarWidth()+"px";if(this._allBackdropClose){this._backdrop.onclick=e=>{if(e.target===this._backdrop)this.close()}}if(this._allEscapeClose){document.addEventListener("keydown",this._handleEscapeKey)}this._onTransitionEnd(this.opt.onOpen);return this._backdrop};Popzy.prototype.close=function(destroy=this.opt.destroyOnClose){Popzy.elements.pop();this._backdrop.classList.remove("popzy--show");document.removeEventListener("keydown",this._handleEscapeKey);this._onTransitionEnd(()=>{if(this._backdrop&&destroy){this._backdrop.remove();this._backdrop=null;this._modalFooter=null}if(!Popzy.elements.length){document.body.classList.remove("popzy--no-scrolling");document.body.style.paddingRight=""}if(typeof this.opt.onClose==="function")this.opt.onClose()})};Popzy.prototype.destroy=()=>{this.close(true)};